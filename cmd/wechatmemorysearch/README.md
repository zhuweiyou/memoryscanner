# WeChatAppEx.exe 内存搜索工具

这是一个交互式的命令行工具，用于搜索所有 WeChatAppEx.exe 进程内存中的特定字符串。

## 功能特性

- 自动搜索所有正在运行的 WeChatAppEx.exe 进程
- 交互式输入搜索字符串和搜索长度
- 支持模糊搜索（使用 `?` 作为通配符，例如 `we?ha?`）
- 可自定义搜索字节长度（默认1024字节）
- 实时显示搜索进度（每100个匹配项更新一次）
- 控制台显示前10个结果，所有结果记录到日志文件
- 支持中断搜索（Ctrl+C）
- 自动记录搜索结果到带时间戳的日志文件
- 大小写不敏感搜索
- 智能内容格式化，处理特殊字符显示

## 使用方法

### 编译

```bash
cd cmd/wechatmemorysearch
go build -o wechatmemorysearch.exe .
```

### 运行

```bash
./wechatmemorysearch.exe
```

### 交互式使用流程

1. **输入搜索字符串**：支持精确搜索和模糊搜索
   - 精确搜索：直接输入字符串，如 `WeChat`
   - 模糊搜索：使用 `?` 作为通配符，如 `we?ha?`

2. **输入搜索长度**：指定要搜索的字节长度
   - 直接回车使用默认长度 1024 字节
   - 输入数字自定义长度，如 `2048`

### 运行示例

#### 示例1：精确搜索

```
=== WeChatAppEx.exe 内存搜索工具 ===

请输入要搜索的字符串 (支持?模糊搜索，例如we?ha?): WeChat
请输入要搜索的字节长度 (默认1024):

正在搜索 WeChatAppEx.exe 进程...
找到 2 个 WeChatAppEx.exe 进程: [1234 5678]

开始搜索字符串: 'WeChat' (长度: 1024)
按 Ctrl+C 可以随时停止搜索...

正在扫描进程 1234...
进程 1234 已找到 100 个匹配项...
进程 1234 中找到 150 个匹配项:
  [1] 地址: 0x12345678, 内容: 'WeChat'
  [2] 地址: 0x23456789, 内容: 'WeChatVersion'
  [3] 地址: 0x34567890, 内容: 'MyWeChatApp'
  ...
  [10] 地址: 0x56789012, 内容: 'WeChatMiniProgram'
  ... (还有 140 个结果未显示，详见日志文件)

正在扫描进程 5678...
进程 5678 中找到 25 个匹配项:
  [1] 地址: 0x45678901, 内容: 'WeChat'
  [2] 地址: 0x56789012, 内容: 'WeChatApp'
  ...

搜索完成！总共找到 175 个匹配项
```

#### 示例2：模糊搜索

```
=== WeChatAppEx.exe 内存搜索工具 ===

请输入要搜索的字符串 (支持?模糊搜索，例如we?ha?): we?ha?
请输入要搜索的字节长度 (默认1024): 2048

正在搜索 WeChatAppEx.exe 进程...
找到 1 个 WeChatAppEx.exe 进程: [1234]

开始搜索字符串: 'we?ha?' (长度: 2048)
按 Ctrl+C 可以随时停止搜索...

正在扫描进程 1234...
进程 1234 中找到 8 个匹配项:
  [1] 地址: 0x12345678, 内容: 'wechat'
  [2] 地址: 0x23456789, 内容: 'weihao'
  [3] 地址: 0x34567890, 内容: 'wehcat'

搜索完成！总共找到 8 个匹配项
```

## 日志文件

程序会自动创建日志文件，文件名格式为：`wechatmemorysearch_YYYY-MM-DD_HH-MM-SS.log`

日志文件包含：
- 搜索开始和结束时间（精确到秒）
- 找到的进程ID列表
- 每个进程的搜索结果
- 完整的匹配内容（保留原文格式，包含换行符等特殊字符）

## 技术细节

- **搜索算法**: 使用 AOB (Array of Bytes) 模式匹配
- **模式转换**: `StringToPattern()` 将用户字符串转换为字节模式，支持 `?` 通配符
- **内存扫描**: 扫描进程所有可读内存区域
- **性能优化**:
  - 支持上下文取消（Ctrl+C 中断）
  - 实时进度显示（每100个匹配项更新）
  - 控制台显示限制（前10个结果）
  - 智能内容格式化（处理换行符、制表符等特殊字符）
- **内存范围**: 0x0 到 0x7FFFFFFFFFFF
- **结果处理**:
  - 控制台输出：截断显示特殊字符，限制长度
  - 日志文件：完整保留原始内容
- **交互模式**: 使用 `bufio.NewReader` 处理用户输入

## 安全说明

此工具仅用于教育和安全研究目的。在使用前请确保：

1. 您有权限访问目标进程
2. 遵守当地法律法规
3. 不要用于恶意目的

## 系统要求

- Windows 操作系统
- Go 1.21 或更高版本
- 管理员权限（用于访问其他进程内存）

## 故障排除

### "未找到 WeChatAppEx.exe 进程"
- 确保 WeChatAppEx.exe 正在运行
- 尝试以管理员身份运行

### "访问被拒绝"
- 以管理员身份运行程序
- 检查目标进程的权限设置

### "扫描失败"
- 目标进程可能已经退出
- 内存区域可能无法访问（这是正常的）